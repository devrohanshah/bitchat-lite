#:import dp kivy.metrics.dp

<ChatRoot>:
    orientation: 'vertical'
    padding: dp(8)
    spacing: dp(6)

    BoxLayout:
        size_hint_y: None
        height: dp(40)
        TextInput:
            id: pass_input
            hint_text: 'Shared passphrase'
            text: root.passphrase
            multiline: False
            on_text_validate: root.passphrase = self.text
            on_text: root.passphrase = self.text
        Button:
            text: 'Scan'
            size_hint_x: None
            width: dp(90)
            on_release: root.do_scan()
        Button:
            text: 'Start Server'
            size_hint_x: None
            width: dp(120)
            on_release: root.start_server()

    BoxLayout:
        size_hint_y: None
        height: dp(40)
        Spinner:
            id: dev_spinner
            text: 'Select device'
            values: root.devices
            size_hint_x: 1
        Button:
            text: 'Connect'
            size_hint_x: None
            width: dp(100)
            on_release: root.connect_selected(dev_spinner.text)

    ScrollView:
        do_scroll_x: False
        Label:
            id: chat_label
            text: root.chat_log
            text_size: self.width, None
            size_hint_y: None
            halign: 'left'
            valign: 'top'
            padding: dp(4), dp(4)
            on_texture_size: self.height = self.texture_size[1]

    BoxLayout:
        size_hint_y: None
        height: dp(48)
        TextInput:
            id: msg_input
            hint_text: 'Type message'
            multiline: False
            on_text_validate: root.send_msg(self.text)
        Button:
            text: 'Send'
            size_hint_x: None
            width: dp(100)
            on_release: root.send_msg(msg_input.text)
